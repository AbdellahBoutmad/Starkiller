import{_ as l}from"./PluginTasksList-f30b92f9.js";import{_ as u}from"./GeneralForm-75fe576c.js";import{_ as p}from"./TechniqueChips-be9b81e4.js";import{_ as m}from"./InfoViewer-ca0b101a.js";import{_}from"./ErrorStateAlert-1d2f0f9a.js";import{a as c}from"./ListPageTop-66efe50f.js";import{_ as f}from"./EditPageTop-eec03e0c.js";import{n as g,aE as h,aF as d,b as r,c as n,a as b}from"./index-389f8952.js";import{_ as k,a,b as v,c as o}from"./VTabItem-119fa5d5.js";import"./TagViewer-3ebe25cd.js";import"./VSelect-c55174b0.js";import"./DateTimeDisplay-ab745236.js";import"./moment-fbc5633a.js";import"./VTooltip-d7a33ef2.js";import"./TooltipButton-434648f2.js";import"./index-133b2567.js";import"./ansi_up-55f80c92.js";import"./download-stager-ae353708.js";import"./VPagination-ebfa1d31.js";import"./VDataTable-a4253065.js";import"./VSwitch-8c9c6215.js";import"./ExpansionPanelFilter-e50e7d4a.js";import"./VExpansionPanelHeader-2b402dc9.js";import"./ExpansionPanelSearch-41f76c1c.js";import"./AdvancedTable-7d618428.js";import"./VExpansionPanels-fa7175ca.js";import"./VItemGroup-f4c31445.js";import"./tag-api-5cd6c42f.js";import"./bypass-module-4b7396eb.js";import"./bypass-api-7a9fd0b2.js";import"./credential-module-afb4fe5c.js";import"./malleable-module-07e5792b.js";import"./malleable-api-3511c9d3.js";const x={name:"PluginEdit",components:{InfoViewer:m,GeneralForm:u,TechniqueChips:p,EditPageTop:f,PluginTasksList:l,TooltipButtonToggle:c,ErrorStateAlert:_},data(){return{reset:!0,loading:!1,isRefreshTasks:!1,form:{},plugin:{options:{}},errorState:!1}},computed:{breads(){return[{text:"Plugins",disabled:!1,to:"/plugins",exact:!0},{text:this.breadcrumbName,disabled:!0,to:"/plugins/edit"}]},breadcrumbName(){return this.plugin.name?this.plugin.name:this.id?this.id:""},pluginInfo(){return Object.keys(this.plugin).length<1?{}:{authors:this.plugin.authors,description:this.plugin.description,comments:this.plugin.comments}},pluginOptions(){const{options:e}=this.plugin;return e||{}},id(){return this.$route.params.id},tab:{set(e){this.$router.replace({query:{...this.$route.query,tab:e}})},get(){return this.$route.query.tab||"interact"}}},mounted(){this.getPlugin(this.id)},methods:{async submit(){if(!(this.loading||!this.$refs.generalform.$refs.form.validate())){this.loading=!0;try{const e=await h(this.plugin.name,this.form);this.$snack.success(`${e.detail}`)}catch(e){this.$snack.error(`Error: ${e}`)}this.loading=!1}},getPlugin(e){d(e).then(t=>{this.reset=!1,this.plugin=t,setTimeout(()=>{this.reset=!0},500)}).catch(()=>{this.errorState=!0})}}};var y=function(){var t=this,s=t._self._c;return s("div",{staticClass:"p4"},[s("portal",{attrs:{to:"app-bar-extension"}},[s("div",{staticStyle:{display:"flex","flex-direction":"row",width:"100%"}},[s(k,{attrs:{"align-with-title":""},model:{value:t.tab,callback:function(i){t.tab=i},expression:"tab"}},[s(a,{key:"interact",attrs:{href:"#interact"}},[t._v(" Interact "),s(r,{staticClass:"ml-1",attrs:{"x-small":""}},[t._v(" fa-terminal ")])],1),s(a,{key:"tasks",attrs:{href:"#tasks"}},[t._v(" Tasks "),s(r,{staticClass:"ml-1",attrs:{"x-small":""}},[t._v(" fa-sticky-note ")])],1)],1)],1)]),s(f,{attrs:{breads:t.breads,"show-submit":!1,"show-copy":!1,"show-delete":!1,"submit-loading":t.loading},on:{submit:t.submit}},[s("template",{slot:"extra-stuff"},[s(c,{attrs:{icon:"fa-redo","button-text":t.isRefreshTasks?"On":"Off",text:"Auto-refresh tasks"},model:{value:t.isRefreshTasks,callback:function(i){t.isRefreshTasks=i},expression:"isRefreshTasks"}})],1)],2),t.errorState?s(_,{attrs:{"resource-id":t.id,"resource-type":"plugin"}}):s(v,{staticClass:"scrollable-pane",model:{value:t.tab,callback:function(i){t.tab=i},expression:"tab"}},[s(o,{key:"interact",attrs:{value:"interact",transition:!1,"reverse-transition":!1}},[s("h4",{staticClass:"pl-4 pb-4"},[t._v("Execute Plugin")]),s(n,{staticStyle:{padding:"10px"}},[s(m,{staticClass:"info-viewer",attrs:{info:t.pluginInfo}}),s(p,{attrs:{techniques:t.plugin.TechniqueChips}}),t.reset?s(u,{ref:"generalform",attrs:{options:t.plugin.options},model:{value:t.form,callback:function(i){t.form=i},expression:"form"}}):t._e(),s(b,{attrs:{loading:t.loading,color:"primary"},on:{click:t.submit}},[t._v(" Submit ")])],1)],1),s(o,{key:"tasks",attrs:{value:"tasks",transition:!1,"reverse-transition":!1}},[s(n,{attrs:{flat:""}},[s(l,{attrs:{plugin:t.plugin,"refresh-tasks":t.isRefreshTasks}})],1)],1)],1)],1)},T=[],P=g(x,y,T,!1,null,null,null,null);const rt=P.exports;export{rt as default};
