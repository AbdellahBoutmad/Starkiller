import{_ as c}from"./ListPageTop.2a204a11.js";import{e as d,ba as u,bZ as p,b_ as h,b$ as f,c0 as m,c1 as _,c2 as g,c3 as v,c4 as w,c5 as b,n as y,c6 as k,bc as l,a as $,b as r,l as o,aB as C,o as n}from"./index.85262dd3.js";import{_ as i}from"./VSwitch.8a27782c.js";import"./VBreadcrumbs.32f4f2d0.js";const P={components:{ListPageTop:c},data(){return{password:{form:{},loading:!1},rules:{password:[a=>!!a||"Password is required",a=>!!a&&a.length>5||"Password must be larger than 5 characters"],confirmPassword:[a=>!!a||"Confirmation is required",a=>a===this.password.form.password||"Password must match"]},modules:{loading:!1},bypasses:{loading:!1},profiles:{loading:!1},plugins:{loading:!1},showPassword:!1,showConfirm:!1,valid:!1,breads:[{text:"Settings",disabled:!0,href:"/settings"}],avatarUrl:""}},computed:{...d({user:a=>a.application.user,darkMode:a=>a.application.darkMode,chatWidget:a=>a.application.chatWidget,autoSubscribeAgents:a=>a.application.autoSubscribeAgents}),userId(){return this.user.id},darkModeSwitch:{set(a){this.$store.dispatch("application/darkMode",a)},get(){return this.darkMode}},chatWidgetSwitch:{set(a){this.$store.dispatch("application/chatWidget",a)},get(){return this.chatWidget}},autoSubscribeSwitch:{set(a){this.$store.dispatch("application/autoSubscribeAgents",a)},get(){return this.autoSubscribeAgents}}},watch:{"user.avatar":{async handler(){!this.user.avatar||(this.avatarUrl=await this.getDownloadUrl(this.user.avatar))},immediate:!0}},methods:{async getDownloadUrl(a){return await u(a.id)},handleFileImport(){this.isSelecting=!0,window.addEventListener("focus",()=>{this.isSelecting=!1},{once:!0}),this.$refs.uploader.click()},async onFileChanged(a){const s=a.target.files[0],e=new FormData;e.append("file",s),await p(this.userId,e),await this.$store.dispatch("application/refreshMe"),this.$snack.success("Upload complete")},async logout(){await this.$root.$confirm("","Are you sure you want to logout?",{color:"green"})&&this.$store.dispatch("application/logout")},clearState(){this.$store.dispatch("application/clear"),this.$store.dispatch("agent/clear")},submit(){this.password.loading||!this.$refs.form.validate()||(this.password.loading=!0,h(this.user.id,this.password.form.password).then(()=>{this.$snack.success("Password updated"),this.password.form={},this.$refs.form.resetValidation()}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.password.loading=!1}))},resetProfiles(){this.profiles.loading=!0,f().then(()=>{this.$snack.success("Profiles reset successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.profiles.loading=!1})},reloadProfiles(){this.profiles.loading=!0,m().then(()=>{this.$snack.success("Profiles reload successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.profiles.loading=!1})},reloadModules(){this.modules.loading=!0,_().then(()=>{this.$snack.success("Module reload successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.modules.loading=!1})},resetModules(){this.modules.loading=!0,g().then(()=>{this.$snack.success("Module reset successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.modules.loading=!1})},reloadBypasses(){this.bypasses.loading=!0,v().then(()=>{this.$snack.success("Bypass reload successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.bypasses.loading=!1})},resetBypasses(){this.bypasses.loading=!0,w().then(()=>{this.$snack.success("Bypass reset successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.bypasses.loading=!1})},reloadPlugins(){this.plugins.loading=!0,b().then(()=>{this.$snack.success("Plugin reload successful")}).catch(a=>{this.$snack.error(`Error: ${a}`)}).finally(()=>{this.plugins.loading=!1})}}};var S=function(){var s=this,e=s._self._c;return e("div",[e(c,{attrs:{breads:s.breads}}),e("div",{staticClass:"page"},[e("div",{staticClass:"first-part point",staticStyle:{display:"flex","flex-direction":"row","align-items":"center"}},[e(k,{staticClass:"ma-2",on:{click:s.handleFileImport}},[s.user.avatar?e(l,{attrs:{src:s.avatarUrl}}):e(l,{attrs:{src:`https://ui-avatars.com/api/?background=random&name=${s.user.username}`}})],1),e("input",{ref:"uploader",staticClass:"d-none",attrs:{type:"file","aria-label":"uploader"},on:{change:s.onFileChanged}}),e("span",{staticClass:"ma-2"},[s._v(s._s(s.user.username))]),e($),e(r,{attrs:{color:"primary",text:""},on:{click:s.logout}},[s._v(" Logout ")])],1),e(o),e("div",{staticStyle:{display:"flex","flex-direction":"row"}},[e(i,{attrs:{label:"Dark Mode"},model:{value:s.darkModeSwitch,callback:function(t){s.darkModeSwitch=t},expression:"darkModeSwitch"}}),e(i,{staticClass:"pl-8",attrs:{label:"Chat Widget"},model:{value:s.chatWidgetSwitch,callback:function(t){s.chatWidgetSwitch=t},expression:"chatWidgetSwitch"}})],1),e(o),s._m(0),e(C,{ref:"form",staticStyle:{"max-width":"500px"},nativeOn:{submit:function(t){return t.preventDefault(),s.submit.apply(null,arguments)}},model:{value:s.valid,callback:function(t){s.valid=t},expression:"valid"}},[e(n,{attrs:{type:s.showPassword?"text":"password","append-icon":s.showPassword?"fa-eye":"fa-eye-slash",rules:s.rules.password,label:"Password",autocomplete:"off",outlined:"",dense:"",required:""},on:{"click:append":function(t){s.showPassword=!s.showPassword}},model:{value:s.password.form.password,callback:function(t){s.$set(s.password.form,"password",t)},expression:"password.form.password"}}),e(n,{attrs:{type:s.showConfirm?"text":"password","append-icon":s.showConfirm?"fa-eye":"fa-eye-slash",rules:s.rules.confirmPassword,label:"Confirm Password",autocomplete:"off",outlined:"",dense:"",required:""},on:{"click:append":function(t){s.showConfirm=!s.showConfirm}},model:{value:s.password.form.confirmPassword,callback:function(t){s.$set(s.password.form,"confirmPassword",t)},expression:"password.form.confirmPassword"}}),e(r,{staticClass:"mt-4 mb-4 primary",attrs:{type:"submit",loading:s.password.loading}},[s._v(" submit ")])],1),e("div",{staticClass:"headers pl-0 mt-2"},[s._m(1),e(i,{attrs:{color:"primary"},model:{value:s.autoSubscribeSwitch,callback:function(t){s.autoSubscribeSwitch=t},expression:"autoSubscribeSwitch"}})],1),e(o),e("div",{staticClass:"headers pl-0 mt-2"},[s._m(2),e(r,{attrs:{color:"error"},on:{click:s.clearState}},[s._v(" Clear ")])],1),e(o),e("div",{staticClass:"headers pl-0 mt-2"},[s._m(3),e("div",{staticClass:"d-flex justify-end"},[e(r,{staticClass:"ml-2 mr-2",attrs:{loading:s.profiles.loading,color:"primary"},on:{click:s.reloadProfiles}},[s._v(" Reload ")]),e(r,{staticClass:"ml-2",attrs:{loading:s.profiles.loading,color:"error"},on:{click:s.resetProfiles}},[s._v(" Reset to Defaults ")])],1)]),e(o),e("div",{staticClass:"headers pl-0 mt-2"},[s._m(4),e("div",{staticClass:"d-flex justify-end"},[e(r,{staticClass:"ml-2 mr-2",attrs:{loading:s.modules.loading,color:"primary"},on:{click:s.reloadModules}},[s._v(" Reload ")]),e(r,{staticClass:"ml-2",attrs:{loading:s.modules.loading,color:"error"},on:{click:s.resetModules}},[s._v(" Reset to Defaults ")])],1)]),e(o),e("div",{staticClass:"headers pl-0 mt-2"},[s._m(5),e("div",{staticClass:"d-flex justify-end"},[e(r,{staticClass:"ml-2 mr-2",attrs:{loading:s.bypasses.loading,color:"primary"},on:{click:s.reloadBypasses}},[s._v(" Reload ")]),e(r,{staticClass:"ml-2",attrs:{loading:s.bypasses.loading,color:"error"},on:{click:s.resetBypasses}},[s._v(" Reset to Defaults ")])],1)]),e(o),e("div",{staticClass:"headers pl-0 mt-2"},[s._m(6),e(r,{attrs:{loading:s.plugins.loading,color:"error"},on:{click:s.reloadPlugins}},[s._v(" Reload ")])],1)],1)],1)},x=[function(){var a=this,s=a._self._c;return s("div",{staticClass:"headers pl-0 mt-2"},[s("h4",[a._v("Update Password")])])},function(){var a=this,s=a._self._c;return s("div",[s("h4",[a._v("Auto-Subscribe to Agents")]),s("span",[a._v(" This will automatically subscribe to agent notifications."),s("br"),a._v(" Turning this off will require you to manually subscribe to agents. ")])])},function(){var a=this,s=a._self._c;return s("div",[s("h4",[a._v("Clear Application State")]),s("span",[a._v(" This will clear UI preferences and other localstorage data.")])])},function(){var a=this,s=a._self._c;return s("div",[s("h4",[a._v("Reload Malleable Profiles")]),s("span",[a._v(" Reload will check for and load new profile configurations."),s("br"),a._v(" Reset will do the same but also reset all database records to defaults. ")])])},function(){var a=this,s=a._self._c;return s("div",[s("h4",[a._v("Reload Modules")]),s("span",[a._v(" Reload will check for and load new module configurations."),s("br"),a._v(" Reset will do the same but also reset all database records to defaults. ")])])},function(){var a=this,s=a._self._c;return s("div",[s("h4",[a._v("Reload Bypasses")]),s("span",[a._v(" Reload will check for and load new bypass configurations."),s("br"),a._v(" Reset will do the same but also reset all database records to defaults. ")])])},function(){var a=this,s=a._self._c;return s("div",[s("h4",[a._v("Reload Plugins")]),s("span",[a._v("Reload will check for and load new plugins.")])])}],M=y(P,S,x,!1,null,null,null,null);const E=M.exports;export{E as default};
